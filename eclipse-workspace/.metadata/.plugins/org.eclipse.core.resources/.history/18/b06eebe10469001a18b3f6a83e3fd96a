#include <stdarg.h>
#include "Console.h"
#include "Keyboard.h"

// singleton console manager
CONSOLEMANAGER gs_stConsoleManager = { 0, };

// should be called once before using console
void kInitializeConsole( int iX, int iY ) {
	// set 0 to CONSOLEMANAGER
	kMenSet( &gs_stConsolemanager, 0, sizeof( gs_stConsolemanager ) );
	// set cursor location
	kSetCursor( iX, iY );
}

// set cursor location and character output location
void kSetCursor( int iX, int iY) {
	int iLinearValue;

	iLinearValue = iY * CONSOLE_WIDTH + iX;

	// select upper cursor location register so we send part of
	// linear value
	kOutPortByte( VGA_PORT_INDEX, VGA_INDEX_UPPERCURSOR );
	kOutportByte (VGA_PORT_DATA, iLinearValue >> 8 );

	// select lower cursor location register so we send part of
	// linear value
	kOutPortByte( VGA_PORT_INDEX, VGA_INDEX_LOWERCURSOR );
	kOutPortByte( VGA_PORT_DATA, iLinearValue & 0xFF );

	// update CONSOLE Manager cursor location
	gs_stConsoleManager.uCurrentPrintOffset = iLinearValue;
}
